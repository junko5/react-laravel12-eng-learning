import{b as H,r as s,j as e}from"./app-DHacbUUS.js";import{u as U,a as D,b as K,Q as p,c as M,d as P,s as Y}from"./use-quiz-sound-CR9aS4Lg.js";import{Q as Z}from"./QuizHint-DUjUDXvm.js";/* empty css            */function V(){const{englishWords:A,config:n}=H().props,{playCorrectSound:I,playWrongSound:y}=U(),[w,k]=s.useState(!1),[q,F]=s.useState([]),[r,Q]=s.useState(null),[S,l]=s.useState(""),[o,i]=s.useState(""),[c,d]=s.useState(0),[m,x]=s.useState(0),[f,g]=s.useState(0),[a,v]=s.useState(n.timerDuration),[N,z]=s.useState(!1),[h,b]=s.useState(!1),[C,T]=s.useState([]),j=()=>{k(!0),Q(null),i(""),x(0),g(0),l(""),d(0),T([]);const t=Y(A).slice(0,n.totalQuestions);F(t),W(t[0])};s.useEffect(()=>{j()},[]),s.useEffect(()=>{if(h&&a>0&&!N&&o!=="正解"){const t=setTimeout(()=>v(a-1),1e3);return()=>clearTimeout(t)}else a===0&&h&&(z(!0),i("時間切れ"),b(!1),y(),r&&!C.some(t=>t.word===r.word)&&T(t=>[...t,{word:r.word,meaning:r.meaning}]))},[a,h,N,o]),s.useEffect(()=>{const t=u=>{u.key==="Enter"&&o==="時間切れ"&&(u.preventDefault(),E())};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[o]);const W=t=>{Q(t),l(""),i(""),d(0),v(n.timerDuration),z(!1),b(!0)},R=t=>{if(!t||t===""||o==="正解"||o==="時間切れ"||!r?.word)return;const u=t.trim().toLowerCase(),_=r.word.toLowerCase();if(u===_)i("正解"),b(!1),I(),c===0?x(m+n.scoreFirstTry):c===1&&x(m+n.scoreSecondTry),l(""),setTimeout(()=>{L()},1200);else{const $=c+1;d($),y(),i("不正解")}},E=()=>{l(""),L()},L=()=>{const t=f+1;if(t>=n.totalQuestions){g(t);return}const u=q[t];W(u),g(t),d(0),i("")};return w&&f>=n.totalQuestions?e.jsx(D,{maxWidth:"md",textAlign:"center",children:e.jsx(K,{score:m,config:n,onRestart:j,quizType:"input_advanced",wrongWords:C})}):e.jsx(D,{children:w?e.jsxs("div",{children:[e.jsx(M,{questionNumber:f+1,totalQuestions:n.totalQuestions,score:m}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"残り時間"}),e.jsxs("span",{className:`text-lg font-bold ${a<=3?"text-red-500 animate-pulse":"text-blue-600"}`,children:[a,"秒"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all duration-1000 ${a<=3?"bg-red-500":"bg-blue-500"}`,style:{width:`${a/n.timerDuration*100}%`}})})]}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("h2",{className:"text-lg md:text-xl font-bold text-gray-800 mb-3",children:[n.timerDuration,"秒以内に英語で回答"]}),r&&e.jsxs("div",{children:[e.jsx(P,{content:r.meaning,theme:"red"}),e.jsx("form",{onSubmit:t=>{t.preventDefault(),R(S)},children:e.jsxs("div",{className:"grid gap-3",children:[e.jsx(Z,{wrongCount:c,currentWord:r?.word||"",message:o,currentQuiz:r,quizType:"input_advanced"}),o==="時間切れ"?e.jsx("button",{onClick:E,className:p.buttons.secondary,children:"次の問題へ →"}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",value:S,autoFocus:!0,onChange:t=>l(t.target.value),className:"w-full p-4 border border-gray-300 rounded-xl text-lg text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"submit",className:p.buttons.primary,children:"回答"})]})]})})]})]})]}):e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full mx-auto mb-6 flex items-center justify-center",children:e.jsx("span",{className:"text-4xl",children:"📚"})}),e.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"くまたと英単語"}),e.jsxs("p",{className:"text-gray-600 text-lg",children:[n.totalQuestions,"問の英単語クイズに挑戦しよう！"]})]}),e.jsx("button",{onClick:()=>j(),className:p.buttons.primary,children:"スタート"})]})})}export{V as default};
